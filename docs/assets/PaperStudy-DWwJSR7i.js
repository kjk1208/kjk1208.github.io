import{r as c,g as q,j as e,D as B,a as R,B as i,P as J,b as W,c as G,d as K,e as Q,f as o,I as j,R as D,T as U,h as X,i as Y,k as Z,C as P,l as T,m as ee,n as se,o as te,p as $,q as S,E as ae,A as le,S as ne,s as re,t as ce,u as C}from"./index-DCnD7E4S.js";const d=[{value:"VTON",label:"VTON",icon:"👕"},{value:"LLM",label:"LLM",icon:"🤖"},{value:"stock",label:"주식",icon:"📈"}];function de(){const[m,_]=c.useState("VTON"),[x,f]=c.useState([]),[I,v]=c.useState(!1),[a,g]=c.useState(null),[M,N]=c.useState(!1),[k,h]=c.useState(!1),[n,u]=c.useState({title:"",content:"",tags:""}),[r,p]=c.useState({title:"",content:"",tags:""});c.useEffect(()=>{O()},[]);const O=async()=>{try{const s=await q("papers");s&&f(s)}catch(s){console.error("Failed to load papers:",s);const t=localStorage.getItem("papers");t&&f(JSON.parse(t))}},b=async s=>{f(s);try{await ce("papers",s)}catch(t){console.error("Failed to save papers to server:",t),localStorage.setItem("papers",JSON.stringify(s))}},z=async()=>{if(!n.title.trim()||!n.content.trim())return;const t=[{id:Date.now().toString(),title:n.title,content:n.content,category:m,tags:n.tags.split(",").map(l=>l.trim()).filter(l=>l),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},...x];await b(t),u({title:"",content:"",tags:""}),v(!1)},A=s=>{p({title:s.title,content:s.content,tags:s.tags.join(", ")}),h(!0)},E=async()=>{if(!a||!r.title.trim()||!r.content.trim())return;const s={...a,title:r.title,content:r.content,tags:r.tags.split(",").map(l=>l.trim()).filter(l=>l),updatedAt:new Date().toISOString()},t=x.map(l=>l.id===a.id?s:l);await b(t),g(s),h(!1)},F=async s=>{if(confirm("정말 이 글을 삭제하시겠습니까?")){const t=x.filter(l=>l.id!==s);await b(t),g(null),N(!1)}},H=s=>{g(s),N(!0)},L=()=>{g(null),N(!1),h(!1)},w=s=>x.filter(t=>t.category===s),y=s=>d.find(l=>l.value===s)?.icon||"📄";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"논문 스터디"}),e.jsx("p",{className:"text-muted-foreground",children:"연구 분야별 논문 정리 및 스터디 기록"})]}),e.jsxs(B,{open:I,onOpenChange:v,children:[e.jsx(R,{asChild:!0,children:e.jsxs(i,{children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"글쓰기"]})}),e.jsxs(W,{className:"max-w-md sm:max-w-2xl lg:max-w-4xl max-h-[90vh] overflow-y-auto w-[95vw] sm:w-[90vw]",children:[e.jsxs(G,{children:[e.jsx(K,{children:"새 논문 스터디 작성"}),e.jsx(Q,{children:"논문 스터디 내용을 작성해주세요."})]}),e.jsxs("div",{className:"space-y-3 sm:space-y-4 p-1 sm:p-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"카테고리:"}),e.jsxs(o,{variant:"outline",className:"text-xs",children:[y(m)," ",d.find(s=>s.value===m)?.label]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(j,{placeholder:"논문 제목 또는 주제를 입력하세요",value:n.title,onChange:s=>u(t=>({...t,title:s.target.value})),className:"text-sm sm:text-base"}),e.jsx(j,{placeholder:"태그를 입력하세요 (쉼표로 구분)",value:n.tags,onChange:s=>u(t=>({...t,tags:s.target.value})),className:"text-sm"})]}),e.jsx("div",{className:"min-h-0",children:e.jsx(D,{value:n.content,onChange:s=>u(t=>({...t,content:s})),placeholder:"논문 내용, 요약, 인사이트 등을 자유롭게 작성하세요.",height:"300px"})}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t",children:[e.jsx(i,{variant:"outline",onClick:()=>v(!1),size:"sm",children:"취소"}),e.jsx(i,{onClick:z,disabled:!n.title.trim()||!n.content.trim(),size:"sm",children:"저장"})]})]})]})]})]}),e.jsxs(U,{value:m,onValueChange:_,className:"w-full",children:[e.jsx(X,{className:"grid w-full grid-cols-3",children:d.map(s=>e.jsxs(Y,{value:s.value,className:"flex items-center gap-2",children:[e.jsx("span",{children:s.icon}),s.label]},s.value))}),d.map(s=>e.jsxs(Z,{value:s.value,className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{children:[s.label," 연구"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["총 ",w(s.value).length,"개의 글"]})]}),e.jsx("div",{className:"grid gap-4",children:w(s.value).length===0?e.jsx(P,{children:e.jsxs(T,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(ee,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"아직 작성된 논문이 없습니다"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["첫 번째 ",s.label," 논문을 작성해보세요!"]})]})}):w(s.value).map(t=>e.jsxs(P,{className:"cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>H(t),children:[e.jsx(se,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs(te,{className:"flex items-center gap-2",children:[e.jsx("span",{children:y(t.category)}),t.title]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mt-2",children:[e.jsx(S,{className:"h-3 w-3"}),$(new Date(t.createdAt),"yyyy.MM.dd",{locale:C})]})]}),e.jsx(i,{variant:"ghost",size:"sm",children:e.jsx(ae,{className:"h-4 w-4"})})]})}),e.jsxs(T,{children:[e.jsx("div",{className:"text-sm line-clamp-3 mb-3",dangerouslySetInnerHTML:{__html:t.content.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/__(.*?)__/g,"<u>$1</u>").replace(/`(.*?)`/g,'<code class="bg-muted px-1 py-0.5 rounded text-xs">$1</code>').replace(/^### (.*$)/gm,"<strong>$1</strong>").replace(/^## (.*$)/gm,"<strong>$1</strong>").replace(/^# (.*$)/gm,"<strong>$1</strong>").replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" class="text-blue-500 underline" target="_blank">$1</a>').substring(0,200)+(t.content.length>200?"...":"")}}),t.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:t.tags.map((l,V)=>e.jsx(o,{variant:"secondary",className:"text-xs",children:l},V))})]})]},t.id))})]},s.value))]}),M&&a&&e.jsx("div",{className:"fixed inset-0 z-50 bg-background",children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("header",{className:"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsxs("div",{className:"container flex h-16 items-center justify-between px-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(i,{variant:"ghost",size:"sm",onClick:L,className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4"}),"목록으로"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:y(a.category)}),e.jsx("h1",{className:"text-lg font-semibold truncate max-w-[300px] sm:max-w-[500px]",children:a.title})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:k?e.jsxs(e.Fragment,{children:[e.jsx(i,{variant:"outline",size:"sm",onClick:()=>h(!1),children:"취소"}),e.jsx(i,{size:"sm",onClick:E,disabled:!r.title.trim()||!r.content.trim(),children:"저장"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>A(a),className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-4 w-4"}),"수정"]}),e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>F(a.id),className:"flex items-center gap-2 text-destructive hover:text-destructive",children:[e.jsx(re,{className:"h-4 w-4"}),"삭제"]})]})})]})}),e.jsx("main",{className:"flex-1 overflow-y-auto",children:e.jsx("div",{className:"container max-w-4xl mx-auto px-4 py-8",children:k?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(o,{variant:"outline",className:"text-base px-3 py-1",children:d.find(s=>s.value===a.category)?.label}),e.jsx("span",{className:"text-muted-foreground",children:"수정 모드"})]}),e.jsx(j,{placeholder:"논문 제목 또는 주제를 입력하세요",value:r.title,onChange:s=>p(t=>({...t,title:s.target.value})),className:"text-lg"}),e.jsx(j,{placeholder:"태그를 입력하세요 (쉼표로 구분)",value:r.tags,onChange:s=>p(t=>({...t,tags:s.target.value}))}),e.jsx("div",{className:"min-h-[60vh]",children:e.jsx(D,{value:r.content,onChange:s=>p(t=>({...t,content:s})),placeholder:"논문 내용, 요약, 인사이트 등을 자유롭게 작성하세요.",height:"600px"})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-8 pb-4 border-b",children:[e.jsx(o,{variant:"outline",className:"text-base px-3 py-1",children:d.find(s=>s.value===a.category)?.label}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx(S,{className:"h-3 w-3"}),"작성: ",$(new Date(a.createdAt),"yyyy.MM.dd HH:mm",{locale:C})]}),a.updatedAt!==a.createdAt&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx(S,{className:"h-3 w-3"}),"수정: ",$(new Date(a.updatedAt),"yyyy.MM.dd HH:mm",{locale:C})]})]}),a.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-8",children:a.tags.map((s,t)=>e.jsx(o,{variant:"secondary",children:s},t))}),e.jsx("div",{className:"prose prose-lg max-w-none",children:e.jsx("div",{className:"text-base leading-relaxed min-h-[60vh]",style:{fontSize:"16px",lineHeight:"1.7"},dangerouslySetInnerHTML:{__html:a.content.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/__(.*?)__/g,"<u>$1</u>").replace(/`(.*?)`/g,'<code class="bg-muted px-2 py-1 rounded text-sm">$1</code>').replace(/```([\s\S]*?)```/g,'<pre class="bg-muted p-4 rounded overflow-x-auto my-4"><code>$1</code></pre>').replace(/^### (.*$)/gm,'<h3 class="text-xl font-semibold mt-6 mb-3">$1</h3>').replace(/^## (.*$)/gm,'<h2 class="text-2xl font-semibold mt-8 mb-4">$1</h2>').replace(/^# (.*$)/gm,'<h1 class="text-3xl font-bold mt-8 mb-5">$1</h1>').replace(/^\* (.*$)/gm,'<li class="ml-4 mb-1">$1</li>').replace(/^(\d+)\. (.*$)/gm,'<li class="ml-4 mb-1">$1. $2</li>').replace(/^> (.*$)/gm,'<blockquote class="border-l-4 border-muted pl-4 italic my-4 text-muted-foreground">$1</blockquote>').replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" class="text-blue-500 underline hover:text-blue-700" target="_blank">$1</a>').replace(/\n/g,"<br>")}})})]})})})]})})]})}export{de as default};
